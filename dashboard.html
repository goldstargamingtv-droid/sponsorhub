<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PromoSync - Dashboard</title>
    <link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=DM+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Intro.js for Onboarding Tour -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/intro.js/7.2.0/introjs.min.css">
    
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-6BST5QZPDL"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-6BST5QZPDL');
    </script>
    <!-- Paywall System -->
    <script src="paywall-system.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-primary: #0a0e1a;
            --bg-secondary: #151b2e;
            --bg-card: rgba(25, 35, 58, 0.6);
            --accent-primary: #00d9ff;
            --accent-secondary: #7b61ff;
            --accent-tertiary: #ff6b9d;
            --text-primary: #ffffff;
            --text-secondary: #a8b2d1;
            --text-muted: #6b7794;
            --border-color: rgba(255, 255, 255, 0.08);
            --success: #00ffa3;
            --warning: #ffd93d;
            --danger: #ff4757;
        }

        /* Dark mode by default, light mode toggle */
        [data-theme="light"] {
            --bg-primary: #f5f7fa;
            --bg-secondary: #ffffff;
            --bg-card: rgba(255, 255, 255, 0.9);
            --text-primary: #1a202c;
            --text-secondary: #4a5568;
            --text-muted: #718096;
            --border-color: rgba(0, 0, 0, 0.1);
        }

        body {
            font-family: 'DM Sans', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            overflow-x: hidden;
            line-height: 1.6;
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        .bg-gradient {
            position: fixed;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: 0;
            opacity: 0.15;
            background: 
                radial-gradient(circle at 20% 50%, var(--accent-primary) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, var(--accent-secondary) 0%, transparent 50%),
                radial-gradient(circle at 40% 20%, var(--accent-tertiary) 0%, transparent 50%);
            filter: blur(100px);
            animation: gradientShift 15s ease infinite;
        }

        @keyframes gradientShift {
            0%, 100% { transform: translate(0, 0) scale(1); }
            33% { transform: translate(50px, -30px) scale(1.1); }
            66% { transform: translate(-30px, 50px) scale(0.9); }
        }

        .container {
            position: relative;
            z-index: 1;
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header with Theme Toggle */
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 30px 0;
            margin-bottom: 40px;
            animation: slideDown 0.6s ease;
            gap: 40px;
        }

        /* Navigation Menu */
        .main-nav {
            display: flex;
            gap: 8px;
            flex: 1;
            justify-content: center;
        }

        .nav-link {
            padding: 10px 20px;
            color: var(--text-secondary);
            text-decoration: none;
            border-radius: 12px;
            font-weight: 600;
            font-size: 14px;
            transition: all 0.3s ease;
            position: relative;
            cursor: pointer;
            background: none;
            border: none;
        }

        .nav-link:hover {
            color: var(--accent-primary);
            background: rgba(0, 217, 255, 0.1);
        }

        .nav-link.active {
            color: var(--text-primary);
            background: rgba(0, 217, 255, 0.15);
        }

        .nav-link.active::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 20px;
            right: 20px;
            height: 2px;
            background: linear-gradient(90deg, var(--accent-primary), var(--accent-secondary));
        }

        /* Page System */
        .page {
            display: none;
        }

        .page.active {
            display: block;
            animation: fadeInUp 0.6s ease;
        }

        .logo {
            font-family: 'Syne', sans-serif;
            font-size: 28px;
            font-weight: 800;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            letter-spacing: -1px;
        }

        .header-actions {
            display: flex;
            gap: 16px;
            align-items: center;
        }

        /* Theme Toggle */
        .theme-toggle {
            width: 50px;
            height: 28px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50px;
            position: relative;
            cursor: pointer;
            transition: background 0.3s;
            border: 1px solid var(--border-color);
        }

        .theme-toggle:hover {
            background: rgba(255, 255, 255, 0.15);
        }

        .theme-toggle-slider {
            position: absolute;
            top: 2px;
            left: 2px;
            width: 22px;
            height: 22px;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            border-radius: 50%;
            transition: transform 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
        }

        [data-theme="light"] .theme-toggle-slider {
            transform: translateX(22px);
        }

        /* Notification Container */
        .notification-container {
            position: relative;
        }

        /* Notification Bell */
        .notification-bell {
            position: relative;
            width: 40px;
            height: 40px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--border-color);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .notification-bell:hover {
            background: rgba(0, 217, 255, 0.1);
            border-color: var(--accent-primary);
        }

        .notification-badge {
            position: absolute;
            top: -2px;
            right: -2px;
            width: 18px;
            height: 18px;
            background: var(--danger);
            border-radius: 50%;
            font-size: 10px;
            font-weight: 700;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Notification Dropdown */
        .notification-dropdown {
            position: absolute;
            top: 60px;
            right: 0;
            width: 380px;
            background: var(--bg-card);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border-color);
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            z-index: 1000;
            opacity: 0;
            transform: translateY(-10px);
            pointer-events: none;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            max-height: 500px;
            overflow: hidden;
        }

        .notification-dropdown.active {
            opacity: 1;
            transform: translateY(0);
            pointer-events: auto;
        }

        .notification-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            border-bottom: 1px solid var(--border-color);
        }

        .notification-title {
            font-family: 'Syne', sans-serif;
            font-size: 18px;
            font-weight: 700;
        }

        .mark-all-read {
            background: none;
            border: none;
            color: var(--accent-primary);
            font-weight: 600;
            font-size: 13px;
            cursor: pointer;
            transition: opacity 0.3s;
        }

        .mark-all-read:hover {
            opacity: 0.7;
        }

        .notification-list {
            max-height: 400px;
            overflow-y: auto;
        }

        .notification-item {
            padding: 16px 20px;
            border-bottom: 1px solid var(--border-color);
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
        }

        .notification-item:hover {
            background: rgba(255, 255, 255, 0.03);
        }

        .notification-item:last-child {
            border-bottom: none;
        }

        .notification-item.unread {
            background: rgba(0, 217, 255, 0.05);
        }

        .notification-item.unread::before {
            content: '';
            position: absolute;
            left: 8px;
            top: 50%;
            transform: translateY(-50%);
            width: 8px;
            height: 8px;
            background: var(--accent-primary);
            border-radius: 50%;
        }

        .notification-content {
            display: flex;
            gap: 12px;
            align-items: start;
        }

        .notification-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            flex-shrink: 0;
        }

        .notification-icon.success {
            background: rgba(0, 255, 163, 0.15);
        }

        .notification-icon.info {
            background: rgba(0, 217, 255, 0.15);
        }

        .notification-icon.warning {
            background: rgba(255, 217, 61, 0.15);
        }

        .notification-icon.payment {
            background: rgba(255, 107, 157, 0.15);
        }

        .notification-text {
            flex: 1;
        }

        .notification-text h4 {
            font-weight: 600;
            font-size: 14px;
            margin-bottom: 4px;
        }

        .notification-text p {
            color: var(--text-secondary);
            font-size: 13px;
            margin-bottom: 4px;
        }

        .notification-time {
            color: var(--text-muted);
            font-size: 12px;
        }

        .notification-footer {
            padding: 16px 20px;
            text-align: center;
            border-top: 1px solid var(--border-color);
        }

        .view-all-notifications {
            color: var(--accent-primary);
            text-decoration: none;
            font-weight: 600;
            font-size: 14px;
            transition: opacity 0.3s;
        }

        .view-all-notifications:hover {
            opacity: 0.7;
        }

        .notification-empty {
            padding: 60px 20px;
            text-align: center;
        }

        .notification-empty-icon {
            font-size: 48px;
            margin-bottom: 16px;
            opacity: 0.3;
        }

        .notification-empty h4 {
            font-family: 'Syne', sans-serif;
            margin-bottom: 8px;
        }

        .notification-empty p {
            color: var(--text-secondary);
            font-size: 14px;
        }

        /* Scrollbar Styling */
        .notification-list::-webkit-scrollbar {
            width: 6px;
        }

        .notification-list::-webkit-scrollbar-track {
            background: transparent;
        }

        .notification-list::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
        }

        .notification-list::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        /* Backdrop for closing dropdown */
        .notification-backdrop {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: 999;
            display: none;
        }

        .notification-backdrop.active {
            display: block;
        }

        /* Reopen Pending Actions Button */
        .reopen-actions-btn {
            position: fixed;
            bottom: 100px;
            right: 30px;
            z-index: 1000;
            padding: 14px 24px;
            background: linear-gradient(135deg, var(--accent-tertiary), var(--accent-secondary));
            border: none;
            border-radius: 50px;
            color: white;
            font-weight: 700;
            cursor: pointer;
            box-shadow: 0 10px 40px rgba(255, 107, 157, 0.4);
            font-size: 14px;
            display: none;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
            animation: slideInFromRight 0.5s ease;
        }

        .reopen-actions-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 50px rgba(255, 107, 157, 0.6);
        }

        .reopen-actions-btn.show {
            display: flex;
        }

        @keyframes slideInFromRight {
            from {
                opacity: 0;
                transform: translateX(100px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        /* Pending Actions - Show/Hide Animation */
        .pending-actions.hidden {
            display: none;
        }

        .pending-actions.show {
            display: block;
            animation: fadeInUp 0.5s ease;
        }

        /* Pending Actions Widget - NEW! */
        .pending-actions {
            background: linear-gradient(135deg, rgba(255, 107, 157, 0.1), rgba(123, 97, 255, 0.1));
            border: 2px solid var(--accent-tertiary);
            border-radius: 20px;
            padding: 24px;
            margin-bottom: 32px;
            animation: fadeInUp 0.6s ease;
        }

        .pending-actions-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .pending-actions-title {
            font-family: 'Syne', sans-serif;
            font-size: 20px;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .urgent-badge {
            background: var(--danger);
            color: white;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 700;
            text-transform: uppercase;
        }

        .action-item {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s;
            cursor: pointer;
        }

        .action-item:hover {
            background: rgba(255, 255, 255, 0.06);
            border-color: var(--accent-primary);
            transform: translateX(4px);
        }

        .action-item:last-child {
            margin-bottom: 0;
        }

        .action-info {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .action-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }

        .action-icon.warning {
            background: rgba(255, 217, 61, 0.15);
        }

        .action-icon.success {
            background: rgba(0, 255, 163, 0.15);
        }

        .action-icon.info {
            background: rgba(0, 217, 255, 0.15);
        }

        .action-text h4 {
            font-weight: 600;
            margin-bottom: 4px;
        }

        .action-text p {
            font-size: 13px;
            color: var(--text-secondary);
        }

        .action-btn {
            padding: 8px 20px;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            border: none;
            border-radius: 8px;
            color: white;
            font-weight: 600;
            font-size: 14px;
            cursor: pointer;
            transition: transform 0.3s;
        }

        .action-btn:hover {
            transform: translateY(-2px);
        }

        /* Stats Grid with Sparklines */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
            animation: fadeInUp 0.8s ease 0.2s backwards;
        }

        .stat-card {
            background: var(--bg-card);
            backdrop-filter: blur(10px);
            border: 1px solid var(--border-color);
            border-radius: 20px;
            padding: 28px;
            position: relative;
            overflow: hidden;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--accent-primary), var(--accent-secondary));
            transform: scaleX(0);
            transition: transform 0.4s ease;
        }

        .stat-card:hover {
            transform: translateY(-8px);
            border-color: var(--accent-primary);
            box-shadow: 0 20px 60px rgba(0, 217, 255, 0.15);
        }

        .stat-card:hover::before {
            transform: scaleX(1);
        }

        .stat-label {
            color: var(--text-secondary);
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .stat-value {
            font-family: 'Syne', sans-serif;
            font-size: 36px;
            font-weight: 700;
            margin-bottom: 12px;
            background: linear-gradient(135deg, var(--text-primary), var(--text-secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .stat-change {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            font-size: 14px;
            font-weight: 600;
            padding: 6px 12px;
            border-radius: 20px;
            background: rgba(0, 255, 163, 0.1);
            color: var(--success);
        }

        .stat-change.negative {
            background: rgba(255, 71, 87, 0.1);
            color: var(--danger);
        }

        /* Sparkline - NEW! */
        .sparkline {
            margin-top: 16px;
            height: 40px;
            position: relative;
        }

        .sparkline svg {
            width: 100%;
            height: 100%;
        }

        /* Empty State - NEW! */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            background: rgba(255, 255, 255, 0.02);
            border: 2px dashed var(--border-color);
            border-radius: 20px;
            margin: 20px 0;
        }

        .empty-state-icon {
            font-size: 64px;
            margin-bottom: 20px;
            opacity: 0.5;
        }

        .empty-state h3 {
            font-family: 'Syne', sans-serif;
            font-size: 24px;
            margin-bottom: 12px;
        }

        .empty-state p {
            color: var(--text-secondary);
            margin-bottom: 24px;
            max-width: 400px;
            margin-left: auto;
            margin-right: auto;
        }

        .empty-state-cta {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 14px 28px;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            color: white;
            border: none;
            border-radius: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            text-decoration: none;
        }

        .empty-state-cta:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(0, 217, 255, 0.3);
        }

        /* Cards remain the same but with hover effects */
        .card {
            background: var(--bg-card);
            backdrop-filter: blur(10px);
            border: 1px solid var(--border-color);
            border-radius: 24px;
            padding: 32px;
            transition: all 0.3s ease;
        }

        .card:hover {
            border-color: rgba(255, 255, 255, 0.15);
            transform: translateY(-2px);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 28px;
        }

        .card-title {
            font-family: 'Syne', sans-serif;
            font-size: 24px;
            font-weight: 700;
            letter-spacing: -0.5px;
        }

        .view-all {
            color: var(--accent-primary);
            text-decoration: none;
            font-weight: 600;
            font-size: 14px;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .view-all:hover {
            gap: 10px;
        }

        /* Main Grid */
        .main-grid {
            display: grid;
            grid-template-columns: 1.5fr 1fr;
            gap: 24px;
            margin-bottom: 40px;
        }

        /* User Profile */
        .user-profile {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 8px 16px;
            background: var(--bg-card);
            backdrop-filter: blur(10px);
            border: 1px solid var(--border-color);
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .user-profile:hover {
            border-color: var(--accent-primary);
            transform: translateY(-2px);
        }

        .user-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 14px;
        }

        /* Profile Dropdown */
        .profile-dropdown {
            position: absolute;
            top: 70px;
            right: 20px;
            background: var(--bg-card);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 8px;
            min-width: 200px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
            z-index: 1000;
            opacity: 0;
            transform: translateY(-10px);
            pointer-events: none;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .profile-dropdown.active {
            opacity: 1;
            transform: translateY(0);
            pointer-events: auto;
        }

        .profile-menu-item {
            padding: 12px 16px;
            border-radius: 8px;
            cursor: pointer;
            transition: background 0.2s;
            font-size: 14px;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .profile-menu-item:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        /* Continue with existing styles... */
        /* (I'll add more in the next section to keep file manageable) */

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Responsive */
        @media (max-width: 968px) {
            .main-grid {
                grid-template-columns: 1fr;
            }
            .stats-grid {
                grid-template-columns: 1fr;
            }
        }
    
        /* ========== MARKETPLACE ENHANCEMENTS ========== */

/* Match Score Badge */
.match-score {
    position: absolute;
    top: 16px;
    right: 16px;
    background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
    color: white;
    padding: 8px 16px;
    border-radius: 50px;
    font-weight: 700;
    font-size: 14px;
    display: flex;
    align-items: center;
    gap: 6px;
    box-shadow: 0 4px 20px rgba(0, 217, 255, 0.3);
}

.match-score.high {
    background: linear-gradient(135deg, var(--success), #00cc82);
    box-shadow: 0 4px 20px rgba(0, 255, 163, 0.3);
}

.match-score.medium {
    background: linear-gradient(135deg, var(--warning), #ffb700);
    box-shadow: 0 4px 20px rgba(255, 217, 61, 0.3);
}

.match-score.low {
    background: linear-gradient(135deg, var(--text-muted), #586678);
}

/* Advanced Filters Panel */
.filters-panel {
    background: var(--bg-card);
    border: 1px solid var(--border-color);
    border-radius: 20px;
    padding: 28px;
    margin-bottom: 32px;
    backdrop-filter: blur(10px);
}

.filters-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 24px;
}

.filters-title {
    font-family: 'Syne', sans-serif;
    font-size: 20px;
    font-weight: 700;
}

.clear-filters {
    background: none;
    border: none;
    color: var(--accent-primary);
    font-weight: 600;
    cursor: pointer;
    font-size: 14px;
    transition: opacity 0.3s;
}

.clear-filters:hover {
    opacity: 0.7;
}

.filters-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 24px;
}

.filter-group {
    display: flex;
    flex-direction: column;
    gap: 12px;
}

.filter-label {
    font-weight: 600;
    font-size: 14px;
    color: var(--text-secondary);
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.filter-select {
    padding: 12px 16px;
    background: rgba(255, 255, 255, 0.03);
    border: 1px solid var(--border-color);
    border-radius: 12px;
    color: var(--text-primary);
    font-size: 14px;
    cursor: pointer;
    transition: all 0.3s;
}

.filter-select:focus {
    outline: none;
    border-color: var(--accent-primary);
    background: rgba(255, 255, 255, 0.05);
}

/* Range Slider */
.range-slider {
    width: 100%;
    margin-top: 8px;
}

.range-slider input[type="range"] {
    width: 100%;
    height: 6px;
    border-radius: 10px;
    background: linear-gradient(to right, var(--accent-primary), var(--accent-secondary));
    outline: none;
    -webkit-appearance: none;
}

.range-slider input[type="range"]::-webkit-slider-thumb {
    -webkit-appearance: none;
    width: 20px;
    height: 20px;
    border-radius: 50%;
    background: white;
    cursor: pointer;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
    transition: transform 0.2s;
}

.range-slider input[type="range"]::-webkit-slider-thumb:hover {
    transform: scale(1.2);
}

.range-value {
    display: flex;
    justify-content: space-between;
    margin-top: 8px;
    font-size: 13px;
    color: var(--text-secondary);
}

.range-value .current {
    color: var(--accent-primary);
    font-weight: 700;
}

/* Multi-select Tags */
.tag-select {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
}

.tag-option {
    padding: 8px 16px;
    background: rgba(255, 255, 255, 0.03);
    border: 1px solid var(--border-color);
    border-radius: 20px;
    font-size: 13px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s;
}

.tag-option:hover {
    border-color: var(--accent-primary);
    background: rgba(0, 217, 255, 0.1);
}

.tag-option.selected {
    background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
    color: white;
    border-color: transparent;
}

/* Favorite Heart Button */
.favorite-btn {
    position: absolute;
    top: 16px;
    left: 16px;
    width: 40px;
    height: 40px;
    background: rgba(0, 0, 0, 0.5);
    backdrop-filter: blur(10px);
    border: 1px solid var(--border-color);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    font-size: 18px;
    transition: all 0.3s;
    z-index: 10;
}

.favorite-btn:hover {
    transform: scale(1.1);
    background: rgba(0, 0, 0, 0.7);
}

.favorite-btn.active {
    background: linear-gradient(135deg, var(--accent-tertiary), #ff4757);
    border-color: transparent;
}

/* Quick Apply Modal */
.modal-backdrop {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.7);
    backdrop-filter: blur(8px);
    z-index: 2000;
    display: none;
    align-items: center;
    justify-content: center;
}

.modal-backdrop.active {
    display: flex;
}

.apply-modal {
    background: var(--bg-card);
    backdrop-filter: blur(20px);
    border: 1px solid var(--border-color);
    border-radius: 24px;
    padding: 40px;
    max-width: 600px;
    width: 90%;
    max-height: 80vh;
    overflow-y: auto;
    position: relative;
    animation: modalSlideIn 0.3s ease;
}

@keyframes modalSlideIn {
    from {
        opacity: 0;
        transform: translateY(-50px) scale(0.9);
    }
    to {
        opacity: 1;
        transform: translateY(0) scale(1);
    }
}

.modal-close {
    position: absolute;
    top: 20px;
    right: 20px;
    width: 32px;
    height: 32px;
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid var(--border-color);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    font-size: 18px;
    transition: all 0.3s;
}

.modal-close:hover {
    background: var(--danger);
    border-color: transparent;
    transform: rotate(90deg);
}

.modal-header {
    margin-bottom: 28px;
}

.modal-brand-info {
    display: flex;
    align-items: center;
    gap: 16px;
    margin-bottom: 20px;
}

.modal-brand-logo {
    width: 64px;
    height: 64px;
    border-radius: 16px;
    background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 28px;
    font-weight: 700;
}

.modal-brand-text h2 {
    font-family: 'Syne', sans-serif;
    font-size: 24px;
    margin-bottom: 4px;
}

.modal-brand-text p {
    color: var(--text-secondary);
    font-size: 14px;
}

.modal-section {
    margin-bottom: 28px;
}

.modal-section-title {
    font-weight: 700;
    font-size: 16px;
    margin-bottom: 12px;
    color: var(--accent-primary);
}

.media-kit-select {
    display: flex;
    flex-direction: column;
    gap: 12px;
}

.media-kit-option {
    padding: 16px;
    background: rgba(255, 255, 255, 0.03);
    border: 2px solid var(--border-color);
    border-radius: 12px;
    cursor: pointer;
    transition: all 0.3s;
    display: flex;
    align-items: center;
    gap: 12px;
}

.media-kit-option:hover {
    border-color: var(--accent-primary);
    background: rgba(0, 217, 255, 0.05);
}

.media-kit-option.selected {
    border-color: var(--accent-primary);
    background: rgba(0, 217, 255, 0.1);
}

.media-kit-radio {
    width: 20px;
    height: 20px;
    border: 2px solid var(--border-color);
    border-radius: 50%;
    position: relative;
}

.media-kit-option.selected .media-kit-radio {
    border-color: var(--accent-primary);
}

.media-kit-option.selected .media-kit-radio::after {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 10px;
    height: 10px;
    background: var(--accent-primary);
    border-radius: 50%;
}

.media-kit-info h4 {
    font-weight: 600;
    margin-bottom: 4px;
}

.media-kit-info p {
    font-size: 13px;
    color: var(--text-secondary);
}

.pitch-textarea {
    width: 100%;
    min-height: 120px;
    padding: 16px;
    background: rgba(255, 255, 255, 0.03);
    border: 1px solid var(--border-color);
    border-radius: 12px;
    color: var(--text-primary);
    font-family: 'DM Sans', sans-serif;
    font-size: 14px;
    resize: vertical;
    transition: border-color 0.3s;
}

.pitch-textarea:focus {
    outline: none;
    border-color: var(--accent-primary);
}

.modal-actions {
    display: flex;
    gap: 12px;
}

.modal-btn {
    flex: 1;
    padding: 16px;
    border-radius: 12px;
    font-weight: 700;
    font-size: 16px;
    cursor: pointer;
    transition: all 0.3s;
    border: none;
}

.modal-btn-primary {
    background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
    color: white;
}

.modal-btn-primary:hover {
    transform: translateY(-2px);
    box-shadow: 0 10px 30px rgba(0, 217, 255, 0.4);
}

.modal-btn-secondary {
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid var(--border-color);
    color: var(--text-primary);
}

.modal-btn-secondary:hover {
    background: rgba(255, 255, 255, 0.1);
}

/* Sorting Dropdown */
.sort-dropdown {
    position: relative;
    display: inline-block;
}

.sort-btn {
    padding: 12px 20px;
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid var(--border-color);
    border-radius: 12px;
    color: var(--text-primary);
    font-weight: 600;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 8px;
    transition: all 0.3s;
}

.sort-btn:hover {
    border-color: var(--accent-primary);
    background: rgba(0, 217, 255, 0.1);
}

.sort-menu {
    position: absolute;
    top: 50px;
    right: 0;
    background: var(--bg-card);
    border: 1px solid var(--border-color);
    border-radius: 12px;
    padding: 8px;
    min-width: 200px;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
    z-index: 100;
    display: none;
}

.sort-menu.active {
    display: block;
    animation: fadeInUp 0.2s ease;
}

.sort-option {
    padding: 12px 16px;
    border-radius: 8px;
    cursor: pointer;
    transition: background 0.2s;
    font-size: 14px;
}

.sort-option:hover {
    background: rgba(255, 255, 255, 0.05);
}

.sort-option.active {
    background: rgba(0, 217, 255, 0.1);
    color: var(--accent-primary);
    font-weight: 600;
}

/* Enhanced Brand Card with Position */
.brand-card {
    position: relative;
}

/* Results Count */
.results-info {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 24px;
    padding: 16px 0;
    border-bottom: 1px solid var(--border-color);
}

.results-count {
    font-size: 14px;
    color: var(--text-secondary);
}

.results-count strong {
    color: var(--accent-primary);
    font-weight: 700;
}

/* Brand Marketplace Grid & Cards */
.brand-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(340px, 1fr));
    gap: 24px;
    margin-top: 32px;
}

.brand-header {
    display: flex;
    align-items: center;
    gap: 16px;
    margin-bottom: 20px;
}

.brand-logo-large {
    width: 64px;
    height: 64px;
    border-radius: 16px;
    background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 28px;
    font-weight: 700;
}

.brand-info h3 {
    font-family: 'Syne', sans-serif;
    font-size: 20px;
    font-weight: 700;
    margin-bottom: 4px;
}

.brand-category {
    color: var(--text-secondary);
    font-size: 13px;
}

.brand-stats {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 16px;
    margin: 20px 0;
    padding: 20px 0;
    border-top: 1px solid var(--border-color);
    border-bottom: 1px solid var(--border-color);
}

.brand-stat {
    text-align: center;
}

.brand-stat-value {
    font-family: 'Syne', sans-serif;
    font-size: 20px;
    font-weight: 700;
    color: var(--accent-primary);
    margin-bottom: 4px;
}

.brand-stat-label {
    font-size: 11px;
    color: var(--text-muted);
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.brand-description {
    color: var(--text-secondary);
    font-size: 14px;
    line-height: 1.6;
    margin-bottom: 20px;
}

.tag {
    padding: 6px 12px;
    background: rgba(0, 217, 255, 0.1);
    color: var(--accent-primary);
    border-radius: 20px;
    font-size: 12px;
    font-weight: 600;
}

.apply-btn {
    width: 100%;
    padding: 14px;
    background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
    border: none;
    border-radius: 12px;
    color: white;
    font-weight: 700;
    font-size: 14px;
    cursor: pointer;
    transition: all 0.3s ease;
}

.apply-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 12px 40px rgba(0, 217, 255, 0.3);
}

.section-title {
    font-family: 'Syne', sans-serif;
    font-size: 42px;
    font-weight: 800;
    text-align: center;
    margin-bottom: 16px;
    background: linear-gradient(135deg, var(--text-primary), var(--text-secondary));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

</style>
</head>
<body data-theme="dark">
    <div class="bg-gradient"></div>
    
    <div class="container">
        <!-- Header -->
        <header>
            <div class="logo">PromoSync</div>
            
            <!-- Navigation Menu -->
            <nav class="main-nav">
                <button class="nav-link active" onclick="showPage('dashboard')">Dashboard</button>
                <button class="nav-link" onclick="showPage('marketplace')">Marketplace</button>
                <button class="nav-link" onclick="window.location.href='rate-calculator.html'">Calculator</button>
                <button class="nav-link" onclick="window.location.href='media-kit-builder.html'">Media Kit</button>
                <button class="nav-link" onclick="window.location.href='analytics.html'">Analytics</button>
                <button class="nav-link" onclick="window.location.href='contracts.html'">Contracts</button>
            </nav>
            
            <div class="header-actions">
                <!-- Theme Toggle -->
                <div class="theme-toggle" onclick="toggleTheme()" title="Toggle theme">
                    <div class="theme-toggle-slider">üåô</div>
                </div>
                
                <!-- Notification Bell with Dropdown -->
                <div class="notification-container">
                    <div class="notification-bell" onclick="toggleNotifications()">
                        üîî
                        <span class="notification-badge" id="notificationCount">3</span>
                    </div>
                    
                    <!-- Notification Dropdown -->
                    <div class="notification-dropdown" id="notificationDropdown">
                        <div class="notification-header">
                            <div class="notification-title">Notifications</div>
                            <button class="mark-all-read" onclick="markAllAsRead()">Mark all as read</button>
                        </div>
                        
                        <div class="notification-list" id="notificationList">
                            <!-- Notifications will be inserted here -->
                        </div>
                        
                        <div class="notification-footer">
                            <a href="#" class="view-all-notifications">View All Notifications</a>
                        </div>
                    </div>
                </div>
                
                <!-- User Profile -->
                <div class="user-profile" onclick="toggleProfileMenu()">
                    <div class="user-avatar" id="userAvatar">JD</div>
                    <div>
                        <div style="font-weight: 600; font-size: 14px;" id="userName">Loading...</div>
                        <div style="font-size: 12px; color: var(--text-muted);" id="userTier">Free Plan</div>
                    </div>
                </div>
                
                <!-- Profile Dropdown Menu -->
                <div class="profile-dropdown" id="profileDropdown">
                    <div class="profile-menu-item" onclick="alert('Profile settings coming soon!')">
                        ‚öôÔ∏è Settings
                    </div>
                    <div class="profile-menu-item" onclick="alert('Profile page coming soon!')">
                        üë§ My Profile
                    </div>
                    <div class="profile-menu-item" onclick="logout()" style="color: var(--danger);">
                        üö™ Logout
                    </div>
                </div>
            </div>
        </header>

        <!-- DASHBOARD PAGE -->
        <div id="dashboard" class="page active">
        
        <!-- Pending Actions Widget - NEW! -->
        <div class="pending-actions" data-intro="Stay on top of urgent tasks with your action center!" data-step="1">
            <div class="pending-actions-header">
                <div class="pending-actions-title">
                    ‚ö° Pending Actions
                    <span class="urgent-badge">3 Urgent</span>
                </div>
                <button onclick="dismissActions()" style="background: none; border: none; color: var(--text-muted); cursor: pointer; font-size: 20px;">√ó</button>
            </div>

            <div class="action-item">
                <div class="action-info">
                    <div class="action-icon warning">‚ö†Ô∏è</div>
                    <div class="action-text">
                        <h4>TechCore VPN Contract Needs Signature</h4>
                        <p>Review terms and sign to activate your $2,400 deal</p>
                    </div>
                </div>
                <button class="action-btn" onclick="alert('Opening contract...')">Review</button>
            </div>

            <div class="action-item">
                <div class="action-info">
                    <div class="action-icon success">‚úì</div>
                    <div class="action-text">
                        <h4>RazerGear: 2/5 Deliverables Complete</h4>
                        <p>3 streams remaining before payment milestone</p>
                    </div>
                </div>
                <button class="action-btn" onclick="alert('Viewing deliverables...')">View</button>
            </div>

            <div class="action-item">
                <div class="action-info">
                    <div class="action-icon info">üéØ</div>
                    <div class="action-text">
                        <h4>5 New Brand Matches Available</h4>
                        <p>Brands that fit your niche and audience size</p>
                    </div>
                </div>
                <button class="action-btn" onclick="showPage('marketplace')">Browse</button>
            </div>

            <div class="action-item">
                <div class="action-info">
                    <div class="action-icon info">üìÑ</div>
                    <div class="action-text">
                        <h4>Create Your Media Kit</h4>
                        <p>Build a professional media kit to share with brands</p>
                    </div>
                </div>
                <button class="action-btn" onclick="window.location.href='media-kit-builder.html'">Create Kit</button>
            </div>

            <div class="action-item">
                <div class="action-info">
                    <div class="action-icon success">üßÆ</div>
                    <div class="action-text">
                        <h4>Calculate Your Rate</h4>
                        <p>Use our AI-powered calculator to determine fair pricing</p>
                    </div>
                </div>
                <button class="action-btn" onclick="window.location.href='rate-calculator.html'">Calculate</button>
            </div>
        </div>

        <!-- Stats Grid with Sparklines -->
        <div class="stats-grid" data-intro="Track your revenue, deals, and growth at a glance!" data-step="2">
            <div class="stat-card">
                <div class="stat-label">Total Revenue</div>
                <div class="stat-value">$47,852</div>
                <span class="stat-change">‚Üë 23.5% from last month</span>
                <div class="sparkline">
                    <svg viewBox="0 0 100 40" preserveAspectRatio="none">
                        <polyline fill="none" stroke="url(#gradient1)" stroke-width="2" points="0,30 20,25 40,28 60,15 80,10 100,5"/>
                        <defs>
                            <linearGradient id="gradient1" x1="0%" y1="0%" x2="100%" y2="0%">
                                <stop offset="0%" style="stop-color:#00d9ff;stop-opacity:1" />
                                <stop offset="100%" style="stop-color:#7b61ff;stop-opacity:1" />
                            </linearGradient>
                        </defs>
                    </svg>
                </div>
            </div>

            <div class="stat-card">
                <div class="stat-label">Active Deals</div>
                <div class="stat-value">12</div>
                <span class="stat-change">‚Üë 3 new this week</span>
                <div class="sparkline">
                    <svg viewBox="0 0 100 40" preserveAspectRatio="none">
                        <polyline fill="none" stroke="url(#gradient2)" stroke-width="2" points="0,35 20,32 40,30 60,25 80,20 100,15"/>
                        <defs>
                            <linearGradient id="gradient2" x1="0%" y1="0%" x2="100%" y2="0%">
                                <stop offset="0%" style="stop-color:#00d9ff;stop-opacity:1" />
                                <stop offset="100%" style="stop-color:#7b61ff;stop-opacity:1" />
                            </linearGradient>
                        </defs>
                    </svg>
                </div>
            </div>

            <div class="stat-card">
                <div class="stat-label">Brand Matches</div>
                <div class="stat-value">38</div>
                <span class="stat-change">‚Üë 15 potential partnerships</span>
                <div class="sparkline">
                    <svg viewBox="0 0 100 40" preserveAspectRatio="none">
                        <polyline fill="none" stroke="url(#gradient3)" stroke-width="2" points="0,25 20,28 40,22 60,18 80,12 100,8"/>
                        <defs>
                            <linearGradient id="gradient3" x1="0%" y1="0%" x2="100%" y2="0%">
                                <stop offset="0%" style="stop-color:#00d9ff;stop-opacity:1" />
                                <stop offset="100%" style="stop-color:#7b61ff;stop-opacity:1" />
                            </linearGradient>
                        </defs>
                    </svg>
                </div>
            </div>

            <div class="stat-card">
                <div class="stat-label">Avg Deal Value</div>
                <div class="stat-value">$3,987</div>
                <span class="stat-change">‚Üë 12.3% increase</span>
                <div class="sparkline">
                    <svg viewBox="0 0 100 40" preserveAspectRatio="none">
                        <polyline fill="none" stroke="url(#gradient4)" stroke-width="2" points="0,32 20,30 40,28 60,22 80,18 100,12"/>
                        <defs>
                            <linearGradient id="gradient4" x1="0%" y1="0%" x2="100%" y2="0%">
                                <stop offset="0%" style="stop-color:#00d9ff;stop-opacity:1" />
                                <stop offset="100%" style="stop-color:#7b61ff;stop-opacity:1" />
                            </linearGradient>
                        </defs>
                    </svg>
                </div>
            </div>
        </div>

        <!-- Empty State Example (shown when no active sponsorships) -->
        <div id="emptyStateExample" style="display: none;">
            <div class="empty-state">
                <div class="empty-state-icon">üíº</div>
                <h3>No Active Sponsorships Yet</h3>
                <p>Start exploring brand opportunities matched to your audience. Apply to deals and start earning!</p>
                <button class="empty-state-cta" onclick="showPage('marketplace')">
                    Browse 38 Brand Matches ‚Üí
                </button>
            </div>
        </div>
        </div>
        <!-- END DASHBOARD PAGE -->

        <!-- MARKETPLACE PAGE -->
        <div id="marketplace" class="page">
            <h2 class="section-title">Brand Marketplace</h2>
            <p style="text-align: center; color: var(--text-secondary); margin-bottom: 40px; font-size: 18px;">
                AI-matched brands actively seeking creators like you
            </p>

            <!-- Brand Grid -->
            <div class="brand-grid" id="brandGrid">
                <!-- Brands will be rendered here by JavaScript -->
            </div>
        </div>
        <!-- END MARKETPLACE PAGE -->

        <!-- Tour Start Button (only shown on first visit) -->
        <div style="position: fixed; bottom: 30px; right: 30px; z-index: 1000;" id="tourButton">
            <button onclick="startTour()" style="padding: 16px 24px; background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary)); border: none; border-radius: 50px; color: white; font-weight: 700; cursor: pointer; box-shadow: 0 10px 40px rgba(0, 217, 255, 0.4); font-size: 16px;">
                üéØ Take a Tour
            </button>
        </div>

        <!-- Reopen Pending Actions Button -->
        <button class="reopen-actions-btn" id="reopenActionsBtn" onclick="reopenActions()">
            ‚ö° Show Pending Actions (3)
        </button>
    </div>

    <!-- Notification Backdrop -->
    <div class="notification-backdrop" id="notificationBackdrop" onclick="closeNotifications()"></div>

    <!-- Intro.js Library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/intro.js/7.2.0/intro.min.js"></script>

    <script>
        // Page Navigation System
        function showPage(pageId) {
            // Hide all pages
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            
            // Show selected page
            const selectedPage = document.getElementById(pageId);
            if (selectedPage) {
                selectedPage.classList.add('active');
            }
            
            // Update nav active state
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
            
            // If marketplace, render brands
            if (pageId === 'marketplace') {
                setTimeout(function() {
                    if (typeof renderBrands === 'function') {
                        console.log('Rendering brands...');
                        renderBrands();
                    } else {
                        console.error('renderBrands function not found!');
                    }
                }, 100);
            }
        }

        // Initialize marketplace on page load if it's the active page
        window.addEventListener('load', function() {
            const marketplacePage = document.getElementById('marketplace');
            if (marketplacePage && typeof renderBrands === 'function') {
                renderBrands();
            }
        });

        // Theme Toggle
        function toggleTheme() {
            const html = document.documentElement;
            const currentTheme = html.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            html.setAttribute('data-theme', newTheme);
            
            const slider = document.querySelector('.theme-toggle-slider');
            slider.textContent = newTheme === 'dark' ? 'üåô' : '‚òÄÔ∏è';
            
            localStorage.setItem('theme', newTheme);
        }

        // Load saved theme
        const savedTheme = localStorage.getItem('theme') || 'dark';
        document.documentElement.setAttribute('data-theme', savedTheme);
        if (savedTheme === 'light') {
            document.querySelector('.theme-toggle-slider').textContent = '‚òÄÔ∏è';
        }

        // Notification Center
        // Notifications - Load from localStorage or backend
        let notifications = JSON.parse(localStorage.getItem('notifications') || '[]');

        // Load Notifications from Backend
        async function loadNotifications() {
            try {
                const user = JSON.parse(localStorage.getItem('user') || '{}');
                
                if (!user.id) {
                    // Use demo notifications if no user
                    notifications = [
                        {
                            id: 1,
                            type: 'success',
                            icon: 'üéØ',
                            title: 'New Brand Match',
                            message: 'StreamChair Co is looking for creators like you',
                            time: '5 minutes ago',
                            read: false
                        },
                        {
                            id: 2,
                            type: 'payment',
                            icon: 'üí∞',
                            title: 'Payment Received',
                            message: 'RazerGear sent you $5,200',
                            time: '2 hours ago',
                            read: false
                        },
                        {
                            id: 3,
                            type: 'info',
                            icon: 'üìù',
                            title: 'Contract Renewal Available',
                            message: 'EnergyMax wants to extend your partnership',
                            time: '1 day ago',
                            read: false
                        }
                    ];
                    localStorage.setItem('notifications', JSON.stringify(notifications));
                    renderNotifications();
                    return;
                }

                // Fetch from backend
                const response = await fetch(`${API_URL}/notifications/${user.id}`, {
                    headers: {
                        'Authorization': `Bearer ${localStorage.getItem('authToken')}`
                    }
                });

                if (response.ok) {
                    const data = await response.json();
                    notifications = data.notifications || [];
                    localStorage.setItem('notifications', JSON.stringify(notifications));
                    renderNotifications();
                }
            } catch (error) {
                console.log('Using cached notifications:', error);
                renderNotifications();
            }
        }

        // Render Notifications
        function renderNotifications() {
            const notificationList = document.getElementById('notificationList');
            const unreadCount = notifications.filter(n => !n.read).length;
            
            // Update badge
            const badge = document.getElementById('notificationCount');
            if (unreadCount > 0) {
                badge.textContent = unreadCount;
                badge.style.display = 'flex';
            } else {
                badge.style.display = 'none';
            }
            
            // Clear list
            notificationList.innerHTML = '';
            
            if (notifications.length === 0) {
                notificationList.innerHTML = `
                    <div class="notification-empty">
                        <div class="notification-empty-icon">üîî</div>
                        <h4>All caught up!</h4>
                        <p>You don't have any notifications</p>
                    </div>
                `;
                return;
            }
            
            // Render each notification
            notifications.forEach(notification => {
                const item = document.createElement('div');
                item.className = `notification-item ${notification.read ? '' : 'unread'}`;
                item.onclick = () => markAsRead(notification.id);
                
                item.innerHTML = `
                    <div class="notification-content">
                        <div class="notification-icon ${notification.type}">
                            ${notification.icon}
                        </div>
                        <div class="notification-text">
                            <h4>${notification.title}</h4>
                            <p>${notification.message}</p>
                            <span class="notification-time">${notification.time}</span>
                        </div>
                    </div>
                `;
                
                notificationList.appendChild(item);
            });
        }

        // Toggle Notification Dropdown
        function toggleNotifications() {
            const dropdown = document.getElementById('notificationDropdown');
            const backdrop = document.getElementById('notificationBackdrop');
            
            const isActive = dropdown.classList.contains('active');
            
            if (isActive) {
                closeNotifications();
            } else {
                dropdown.classList.add('active');
                backdrop.classList.add('active');
                renderNotifications();
            }
        }

        // Close Notifications
        function closeNotifications() {
            const dropdown = document.getElementById('notificationDropdown');
            const backdrop = document.getElementById('notificationBackdrop');
            
            dropdown.classList.remove('active');
            backdrop.classList.remove('active');
        }

        // Mark Single Notification as Read
        async function markAsRead(id) {
            const notification = notifications.find(n => n.id === id);
            if (notification && !notification.read) {
                notification.read = true;
                
                // Save to localStorage
                localStorage.setItem('notifications', JSON.stringify(notifications));
                
                // Save to backend
                try {
                    await fetch(`${API_URL}/notifications/${id}/read`, {
                        method: 'PUT',
                        headers: {
                            'Authorization': `Bearer ${localStorage.getItem('authToken')}`
                        }
                    });
                } catch (error) {
                    console.log('Could not sync read status to backend:', error);
                }
                
                renderNotifications();
            }
        }

        // Mark All as Read
        async function markAllAsRead() {
            notifications.forEach(n => n.read = true);
            localStorage.setItem('notifications', JSON.stringify(notifications));
            
            // Sync to backend
            try {
                const user = JSON.parse(localStorage.getItem('user') || '{}');
                if (user.id) {
                    await fetch(`${API_URL}/notifications/mark-all-read`, {
                        method: 'PUT',
                        headers: {
                            'Authorization': `Bearer ${localStorage.getItem('authToken')}`,
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({ user_id: user.id })
                    });
                }
            } catch (error) {
                console.log('Could not sync to backend:', error);
            }
            
            renderNotifications();
        }

        // Close dropdown when clicking escape
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeNotifications();
                closeProfileMenu();
            }
        });

        // Profile Menu Toggle
        function toggleProfileMenu() {
            const menu = document.getElementById('profileDropdown');
            menu.classList.toggle('active');
            
            // Close notifications if open
            closeNotifications();
        }

        function closeProfileMenu() {
            const menu = document.getElementById('profileDropdown');
            menu.classList.remove('active');
        }

        // Logout Function
        function logout() {
            if (confirm('Are you sure you want to logout?')) {
                // Clear authentication
                localStorage.removeItem('authToken');
                localStorage.removeItem('user');
                
                // Redirect to login
                window.location.href = 'login.html';
            }
        }

        // Close menus when clicking outside
        document.addEventListener('click', function(e) {
            if (!e.target.closest('.user-profile') && !e.target.closest('.profile-dropdown')) {
                closeProfileMenu();
            }
        });

        // Dismiss Pending Actions
        function dismissActions() {
            const actions = document.querySelector('.pending-actions');
            const reopenBtn = document.getElementById('reopenActionsBtn');
            
            actions.style.transition = 'all 0.5s ease';
            actions.style.opacity = '0';
            actions.style.transform = 'translateY(-20px)';
            
            setTimeout(() => {
                actions.classList.add('hidden');
                actions.style.opacity = '';
                actions.style.transform = '';
                reopenBtn.classList.add('show');
            }, 500);
        }

        // Reopen Pending Actions
        function reopenActions() {
            const actions = document.querySelector('.pending-actions');
            const reopenBtn = document.getElementById('reopenActionsBtn');
            
            reopenBtn.classList.remove('show');
            actions.classList.remove('hidden');
            actions.classList.add('show');
            
            // Scroll to pending actions
            actions.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        // Onboarding Tour
        function startTour() {
            const intro = introJs();
            intro.setOptions({
                steps: [
                    {
                        element: document.querySelector('.pending-actions'),
                        intro: 'Stay on top of urgent tasks with your action center! Never miss a contract signature or payment milestone.',
                        position: 'bottom'
                    },
                    {
                        element: document.querySelector('.stats-grid'),
                        intro: 'Track your revenue, deals, and growth at a glance. The sparklines show your trends over time.',
                        position: 'bottom'
                    },
                    {
                        intro: 'Welcome to PromoSync! Let me show you around. üëã',
                    }
                ],
                showProgress: true,
                showBullets: false,
                exitOnOverlayClick: false,
                doneLabel: 'Got it!'
            });
            intro.start();
            
            // Hide tour button after first use
            document.getElementById('tourButton').style.display = 'none';
            localStorage.setItem('tourCompleted', 'true');
        }

        // Hide tour button if already completed
        if (localStorage.getItem('tourCompleted') === 'true') {
            document.getElementById('tourButton').style.display = 'none';
        }

        // Check if user has no sponsorships (demo logic)
        const hasActiveSponsorships = true; // Set to false to see empty state
        if (!hasActiveSponsorships) {
            document.getElementById('emptyStateExample').style.display = 'block';
        }

        // Initialize notifications on page load
        document.addEventListener('DOMContentLoaded', function() {
            renderNotifications();
        });
    
        // ========== MARKETPLACE ENHANCEMENTS ==========

// Match Score Calculation Algorithm
function calculateMatchScore(brand, userProfile) {
    let score = 0;
    
    // Niche match (40 points)
    const brandNiches = brand.tags || [];
    const userNiches = userProfile.niches || ['Gaming', 'Tech'];
    const nicheMatches = brandNiches.filter(tag => userNiches.includes(tag)).length;
    score += (nicheMatches / Math.max(brandNiches.length, 1)) * 40;
    
    // Follower count match (30 points)
    const userFollowers = userProfile.followers || 47800;
    const minRequired = brand.minFollowers || 10000;
    if (userFollowers >= minRequired) {
        const ratio = Math.min(userFollowers / minRequired, 3);
        score += Math.min(ratio * 10, 30);
    }
    
    // Budget match (20 points)
    const avgDealValue = userProfile.avgDealValue || 3987;
    const brandBudgetMid = (brand.budgetMin + brand.budgetMax) / 2;
    const budgetDiff = Math.abs(avgDealValue - brandBudgetMid) / avgDealValue;
    score += Math.max(20 - (budgetDiff * 20), 0);
    
    // Engagement rate bonus (10 points)
    const engagement = userProfile.engagement || 12.8;
    if (engagement > 10) score += 10;
    else if (engagement > 5) score += 5;
    
    return Math.round(score);
}

// Sample User Profile
const userProfile = {
    followers: 47800,
    engagement: 12.8,
    niches: ['Gaming', 'Tech', 'Streaming'],
    avgDealValue: 3987
};

// Enhanced Brand Data with Match Scores
const brands = [
    {
        id: 1,
        name: 'RazerGear',
        category: 'Gaming Equipment',
        logo: 'R',
        budgetMin: 3000,
        budgetMax: 8000,
        streams: '3-5',
        minFollowers: 10000,
        description: 'Looking for gaming creators to showcase our latest line of streaming peripherals. Perfect for FPS and competitive gamers.',
        tags: ['Gaming', 'Tech', 'Streaming'],
        gradient: 'linear-gradient(135deg, #00d9ff, #7b61ff)'
    },
    {
        id: 2,
        name: 'EnergyMax',
        category: 'Energy Drinks & Supplements',
        logo: 'E',
        budgetMin: 2000,
        budgetMax: 5000,
        streams: '5-10',
        minFollowers: 5000,
        description: 'Seeking lifestyle and fitness creators for our new zero-sugar energy drink line. Long-term partnership opportunities available.',
        tags: ['Lifestyle', 'Fitness', 'Gaming'],
        gradient: 'linear-gradient(135deg, #ff6b9d, #ffd93d)'
    },
    {
        id: 3,
        name: 'TechCore VPN',
        category: 'Software & Security',
        logo: 'T',
        budgetMin: 1500,
        budgetMax: 4000,
        streams: '2-4',
        minFollowers: 15000,
        description: 'Looking for tech-savvy creators to promote our privacy-focused VPN service. Great for gaming and tech content.',
        tags: ['Tech', 'Gaming', 'Software'],
        gradient: 'linear-gradient(135deg, #00ffa3, #00d9ff)'
    },
    {
        id: 4,
        name: 'GameStream Pro',
        category: 'Streaming Software',
        logo: 'G',
        budgetMin: 4000,
        budgetMax: 10000,
        streams: '6-12',
        minFollowers: 20000,
        description: 'Premium streaming software looking for established creators. Includes revenue share and long-term contract options.',
        tags: ['Software', 'Streaming', 'Premium'],
        gradient: 'linear-gradient(135deg, #7b61ff, #ff6b9d)'
    },
    {
        id: 5,
        name: 'StreamChair Co',
        category: 'Gaming Furniture',
        logo: 'S',
        budgetMin: 2000,
        budgetMax: 6000,
        streams: '4-8',
        minFollowers: 8000,
        description: 'Ergonomic gaming chairs for long streaming sessions. Product + cash compensation. Perfect for setup tours.',
        tags: ['Gaming', 'Furniture', 'Product'],
        gradient: 'linear-gradient(135deg, #ffd93d, #ff6b9d)'
    },
    {
        id: 6,
        name: 'MicroMax Audio',
        category: 'Audio Equipment',
        logo: 'M',
        budgetMin: 3000,
        budgetMax: 7000,
        streams: '3-6',
        minFollowers: 12000,
        description: 'Professional streaming microphones and audio interfaces. Looking for quality-focused content creators.',
        tags: ['Audio', 'Tech', 'Streaming'],
        gradient: 'linear-gradient(135deg, #00d9ff, #00ffa3)'
    }
];

// Calculate match scores for all brands
brands.forEach(brand => {
    brand.matchScore = calculateMatchScore(brand, userProfile);
});

// Filter State
let filters = {
    budgetMin: 0,
    budgetMax: 10000,
    minFollowers: 0,
    tags: [],
    sortBy: 'match' // 'match', 'budget-high', 'budget-low', 'followers'
};

// Favorites
let favorites = JSON.parse(localStorage.getItem('favoriteBrands') || '[]');

// Render Brands
function renderBrands() {
    // Check if elements exist
    const container = document.getElementById('brandGrid');
    if (!container) {
        console.error('brandGrid element not found!');
        return;
    }
    
    let filteredBrands = [...brands];
    
    // Apply filters
    filteredBrands = filteredBrands.filter(brand => {
        const budgetMid = (brand.budgetMin + brand.budgetMax) / 2;
        if (budgetMid < filters.budgetMin || budgetMid > filters.budgetMax) return false;
        if (brand.minFollowers > filters.minFollowers + 50000) return false;
        if (filters.tags.length > 0) {
            const hasTag = filters.tags.some(tag => brand.tags.includes(tag));
            if (!hasTag) return false;
        }
        return true;
    });
    
    // Sort
    if (filters.sortBy === 'match') {
        filteredBrands.sort((a, b) => b.matchScore - a.matchScore);
    } else if (filters.sortBy === 'budget-high') {
        filteredBrands.sort((a, b) => b.budgetMax - a.budgetMax);
    } else if (filters.sortBy === 'budget-low') {
        filteredBrands.sort((a, b) => a.budgetMin - b.budgetMin);
    } else if (filters.sortBy === 'followers') {
        filteredBrands.sort((a, b) => a.minFollowers - b.minFollowers);
    }
    
    // Update count (skip if element doesn't exist)
    const resultsCount = document.getElementById('resultsCount');
    if (resultsCount) {
        resultsCount.innerHTML = 
            `Showing <strong>${filteredBrands.length}</strong> of <strong>${brands.length}</strong> brands`;
    }
    
    // Render
    container.innerHTML = '';
    
    filteredBrands.forEach(brand => {
        const isFavorite = favorites.includes(brand.id);
        const matchClass = brand.matchScore >= 80 ? 'high' : brand.matchScore >= 60 ? 'medium' : 'low';
        
        const card = document.createElement('div');
        card.className = 'brand-card';
        card.innerHTML = `
            <div class="favorite-btn ${isFavorite ? 'active' : ''}" onclick="toggleFavorite(${brand.id})">
                ${isFavorite ? '‚ù§Ô∏è' : 'ü§ç'}
            </div>
            <div class="match-score ${matchClass}">
                üéØ ${brand.matchScore}% Match
            </div>
            <div class="brand-header">
                <div class="brand-logo-large" style="background: ${brand.gradient};">${brand.logo}</div>
                <div class="brand-info">
                    <h3>${brand.name}</h3>
                    <div class="brand-category">${brand.category}</div>
                </div>
            </div>
            <div class="brand-stats">
                <div class="brand-stat">
                    <div class="brand-stat-value">$${(brand.budgetMin/1000).toFixed(1)}K-${(brand.budgetMax/1000).toFixed(1)}K</div>
                    <div class="brand-stat-label">Budget</div>
                </div>
                <div class="brand-stat">
                    <div class="brand-stat-value">${brand.streams}</div>
                    <div class="brand-stat-label">Streams</div>
                </div>
                <div class="brand-stat">
                    <div class="brand-stat-value">${(brand.minFollowers/1000).toFixed(0)}K+</div>
                    <div class="brand-stat-label">Min Followers</div>
                </div>
            </div>
            <div class="brand-description">${brand.description}</div>
            <div style="display: flex; gap: 8px; margin-bottom: 16px;">
                ${brand.tags.map(tag => `<span class="tag">${tag}</span>`).join('')}
            </div>
            <button class="apply-btn" onclick="openApplyModal(${brand.id})">Quick Apply</button>
        `;
        container.appendChild(card);
    });
}

// Toggle Favorite
function toggleFavorite(brandId) {
    const index = favorites.indexOf(brandId);
    if (index > -1) {
        favorites.splice(index, 1);
    } else {
        favorites.push(brandId);
    }
    localStorage.setItem('favoriteBrands', JSON.stringify(favorites));
    renderBrands();
}

// Update Filters
function updateBudgetFilter(value) {
    filters.budgetMax = parseInt(value);
    document.getElementById('budgetValue').textContent = `$${(value/1000).toFixed(1)}K`;
    renderBrands();
}

function updateFollowersFilter(value) {
    filters.minFollowers = parseInt(value);
    document.getElementById('followersValue').textContent = `${(value/1000).toFixed(0)}K`;
    renderBrands();
}

function toggleTagFilter(tag) {
    const index = filters.tags.indexOf(tag);
    if (index > -1) {
        filters.tags.splice(index, 1);
    } else {
        filters.tags.push(tag);
    }
    
    // Update UI
    document.querySelectorAll('.tag-option').forEach(el => {
        if (el.textContent === tag) {
            el.classList.toggle('selected');
        }
    });
    
    renderBrands();
}

function updateSort(sortBy) {
    filters.sortBy = sortBy;
    document.querySelectorAll('.sort-option').forEach(el => el.classList.remove('active'));
    event.target.classList.add('active');
    closeSortMenu();
    renderBrands();
}

function clearFilters() {
    filters = {
        budgetMin: 0,
        budgetMax: 10000,
        minFollowers: 0,
        tags: [],
        sortBy: 'match'
    };
    document.getElementById('budgetSlider').value = 10000;
    document.getElementById('budgetValue').textContent = '$10.0K';
    document.getElementById('followersSlider').value = 0;
    document.getElementById('followersValue').textContent = '0K';
    document.querySelectorAll('.tag-option').forEach(el => el.classList.remove('selected'));
    renderBrands();
}

// Sort Menu
function toggleSortMenu() {
    document.getElementById('sortMenu').classList.toggle('active');
}

function closeSortMenu() {
    document.getElementById('sortMenu').classList.remove('active');
}

// Quick Apply Modal
let currentBrandId = null;

function openApplyModal(brandId) {
    currentBrandId = brandId;
    const brand = brands.find(b => b.id === brandId);
    
    document.getElementById('modalBrandName').textContent = brand.name;
    document.getElementById('modalBrandCategory').textContent = brand.category;
    document.getElementById('modalBrandLogo').textContent = brand.logo;
    document.getElementById('modalBrandLogo').style.background = brand.gradient;
    
    document.getElementById('applyModalBackdrop').classList.add('active');
}

function closeApplyModal() {
    document.getElementById('applyModalBackdrop').classList.remove('active');
    currentBrandId = null;
}

function selectMediaKit(option) {
    document.querySelectorAll('.media-kit-option').forEach(el => el.classList.remove('selected'));
    event.currentTarget.classList.add('selected');
}

function submitApplication() {
    const pitch = document.getElementById('pitchText').value;
    const selectedKit = document.querySelector('.media-kit-option.selected');
    
    if (!selectedKit) {
        alert('Please select a media kit');
        return;
    }
    
    if (!pitch.trim()) {
        alert('Please add a pitch message');
        return;
    }
    
    // Simulate application submission
    alert(`‚úÖ Application submitted to ${brands.find(b => b.id === currentBrandId).name}!\n\nYou'll receive a response within 3-5 business days.`);
    closeApplyModal();
}

// Initialize
document.addEventListener('DOMContentLoaded', function() {
    renderBrands();
    loadUserProfile();
    loadNotifications(); // Load notifications from backend
    
    // Refresh notifications every 60 seconds
    setInterval(loadNotifications, 60000);
});

// Load User Profile Data
function loadUserProfile() {
    try {
        // Get user data from localStorage
        const user = JSON.parse(localStorage.getItem('user') || '{}');
        
        if (user.username || user.email) {
            // Update user name
            const displayName = user.full_name || user.username || user.email.split('@')[0];
            document.getElementById('userName').textContent = displayName;
            
            // Update avatar with initials
            const initials = displayName.split(' ').map(n => n[0]).join('').toUpperCase().slice(0, 2);
            document.getElementById('userAvatar').textContent = initials;
            
            // Update subscription tier
            const tier = user.subscription_tier || user.tier || 'free';
            const tierDisplay = tier === 'free' ? 'Free Plan' : 
                               tier === 'pro' ? 'Pro Member' : 
                               tier === 'premium' ? 'Premium Member' : 
                               'Free Plan';
            document.getElementById('userTier').textContent = tierDisplay;
            
            console.log('User profile loaded:', displayName, tier);
        } else {
            // No user data found - show default
            document.getElementById('userName').textContent = 'Guest';
            document.getElementById('userAvatar').textContent = 'G';
            document.getElementById('userTier').textContent = 'Not logged in';
        }
    } catch (error) {
        console.error('Error loading user profile:', error);
        document.getElementById('userName').textContent = 'User';
        document.getElementById('userAvatar').textContent = 'U';
    }
}

</script>
</body>
</html>
